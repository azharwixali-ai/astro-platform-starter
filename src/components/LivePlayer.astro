---
const streamUrl = "http://xtv.ooo:8080/live/938437191/952117166/167569.m3u8";
---

<!-- 👇 stream-url ko data attribute ke andar inject karte hain -->
<video 
  id="video" 
  data-stream={streamUrl}
  controls 
  autoplay 
  style="width:900px; height:600px; background:black; border-radius:10px;" 
/>

<!-- hls.js from CDN -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest" defer></script>

<script>
  window.addEventListener("load", () => {
    const video = document.getElementById("video");
    const streamUrl = video.dataset.stream; // 👈 yahan se Astro ka value milega

    if (window.Hls && Hls.isSupported()) {
      const hls = new Hls();
      hls.loadSource(streamUrl);
      hls.attachMedia(video);
      console.log("✅ HLS Stream Loaded");
    } else if (video.canPlayType("application/vnd.apple.mpegurl")) {
      video.src = streamUrl;
      console.log("✅ Native HLS Supported");
    } else {
      console.error("❌ HLS not supported in this browser");
    }
  });
</script>
